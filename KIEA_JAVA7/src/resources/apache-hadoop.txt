# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
[ Hadoop 사용 ]

1. 기본적인 시스템 세팅

	$ sudo apt-get update
	
	$ sudo apt-get install default-jdk
	
	$ java -version


2. 하둡을 다운로드 한다.

	http://hadoop.apache.org
	
	$ sudo tar -zxvf hadoop-2.7.3.tar.gz


3. 하둡 유저 세팅

	$ sudo adduser hadoop
	
	$ sudo mv hadoop-2.7.3 /usr/local/
	
	$ sudo chown -R hadoop:hadoop /usr/local/hadoop-2.7.3
	
	$ sudo apt-get install ssh
	
	$ sudo apt-get install rsync


4. login hadoop user

	- 한글문제 해결 : 시스템 설정 > 텍스트 입력창 > 한국어(hangle), 영어(미국) 추가
	
	$ ssh-keygen -t dsa -P '' -f ~/.ssh/id_dsa
	
	$ cat ~/.ssh/id_dsa.pub >> ~/.ssh/authorized_keys
	
	
	$ gedit ~/.bashrc
	
		# Hadoop Variables
		export JAVA_HOME=/usr/lib/jvm/java-1.7.80-openjdk-amd64
		export HADOOP_HOME=/usr/local/hadoop-2.7.3
		export PATH=$PATH:$HADOOP_HOME/bin:$HADOOP_HOME/sbin
		export HADOOP_MAPRED_HOME=$HADOOP_HOME
		export HADOOP_COMMON_HOME=$HADOOP_HOME
		export HADOOP_HDFS_HOME=$HADOOP_HOME
		export YARN_HOME=$HADOOP_HOME
		export HADOOP_COMMON_LIB_NATIVE_DIR=$HADOOP_HOME/lib/native
		export HADOOP_OPTS="-Djava.library.path=$HADOOP_HOME/lib"

	$ source ~/.bashrc
	
	$ cd /usr/local/hadoop-2.7.3/etc/hadoop
	
	$ gedit hadoop-env.sh      <- Hadoop을 실행하는 쉘스크립트 파일 JDK Path, CLASSPATH, 데몬옵션
	
		# The java implementation to use
		export JAVA_HOME="/usr/lib/jvm/java-1.7.80-openjdk-amd64
	
	$ gedit core-site.xml      <- HDFS와 MapReduce에서 공통적으로 사용할 정보들을 설정. hdfs-site와 mapred-site의 공통 설정부분
	
		<configuration>
			<property>
				<name>fs.defaultFS</name>
				<value>hdfs://localhost:9000</value>
			</property>
		</configuration>
		
	$ gedit yarn-site.xml      <- Resource Manager, Node Manager 정보를 설정
	
		<configuration>
			<property>
				<name>yarn.nodemanager.aux-services</name>
				<value>mapreduce_shuffle</value>
			</property>
			<property>
				<name>yarn.nodemanager.aux-services.mapreduce.shuffle.class</name>
				<value>org.apache.hadoop.mapred.ShuffleHandler</value>
			</property>
		</configuration>
	
	$ cp mapred-site.xml.template mapred-site.xml
	
	$ gedit mapred-site.xml      <- MapReduce의 어플리케이션 정보를 설정
	
		<configuration>
			<property>
				<name>mapreduce.framework.name</name>
				<value>yarn</value>
			</property>
		</configuration>
	
	$ gedit hdfs-site.xml      <- 하둡 파일시스템(HDFS)과 관련된 환경정보를 설정
	
		<configuration>
			<property>
				<name>dfs.replication</name>
				<value>1</value>
			</property>
			<property>
				<name>dfs.webhdfs.enabled</name>
				<value>true</value>
			</property>
			<property>
				<name>dfs.namenode.name.dir</name>
				<value>file:/usr/local/hadoop-2.7.3/hadoop_data/hdfs/namenode</value>
			</property>
			<property>
				<name>dfs.datanode.data.dir</name>
				<value>file:/usr/local/hadoop-2.7.3/hadoop_data/hdfs/datanode</value>
			</property>
		</configuration>
	
	$ cd
	
	$ mkdir -p /usr/local/hadoop-2.7.3/hadoop_data/hdfs/namenode
	$ mkdir -p /usr/local/hadoop-2.7.3/hadoop_data/hdfs/datanode
	
	
	$ hdfs namenode -format
	
	$ start-all.sh
	
	$ jps
	
		3538 SecondaryNameNode
		3695 ResourceManager
		3191 NameNode
		3344 DataNode
		5010 Jps
		4011 NodeManager

	----------------------------------------------------------------
	
	- hadoop에 문제가 생기면 아래의 내용을 지우고 다음을 실행한다.
	
		/usr/local/hadoop-2.7.3/hadoop_data/hdfs/namenode
		/usr/local/hadoop-2.7.3/hadoop_data/hdfs/datanode
		
	$ hdfs namenode -format
	
	$ start-all.sh
	
	----------------------------------------------------------------

	아래의 방법으로 VirtualBox 네트워크 forwarding 한다.
	
		http://localhost:8088        http://211.238.142.245:8088
		http://localhost:50070       http://211.238.142.245:50070
		http://localhost:50090       http://211.238.142.245:50090
		http://localhost:50075       http://211.238.142.245:50075
	








# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
# -----------------------------------------------------------------------------------------------------------
